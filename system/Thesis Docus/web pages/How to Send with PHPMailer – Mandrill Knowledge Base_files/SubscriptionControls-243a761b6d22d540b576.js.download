webpackJsonp([8],{1042:function(t,e,s){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(){var t=document.querySelectorAll("[data-helper='subscribe']");[].concat((0,o.default)(t)).forEach(function(t){return new a.default(t)})}Object.defineProperty(e,"__esModule",{value:!0});var i=s(210),o=r(i);e.default=n;var u=s(1459),a=r(u)},1459:function(t,e,s){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=s(160),i=r(n),o=s(2),u=r(o),a=s(45),c=r(a),l=s(16),h=r(l),f=function(){function t(e){var s=this;(0,u.default)(this,t),this.control=e,this.state={isSubscribed:!1,counter:0},this.readAttributes(),this.removeAttributes(),this.control.addEventListener("click",function(t){return s.onClick(t)})}return(0,c.default)(t,[{key:"readAttributes",value:function(){this.hasCounter=this.control.hasAttribute("data-follower-count"),this.state={isSubscribed:"true"===this.control.getAttribute("aria-selected")},this.hasCounter&&(this.state.counter=parseInt(this.control.dataset.followerCount,10)),this.url=this.control.href+".json",this.states=JSON.parse(this.control.dataset.states)}},{key:"removeAttributes",value:function(){var t=this;(0,i.default)(this.control.dataset).forEach(function(e){"followerCount"!==e&&delete t.control.dataset[e]})}},{key:"getStateAttributes",value:function(){return this.states[this.state.isSubscribed?"subscribed":"unsubscribed"]}},{key:"onClick",value:function(t){var e=this;t.preventDefault(),t.stopImmediatePropagation();var s=this.getStateAttributes();this.toggleState(),fetch(this.url,{method:s.method,credentials:"same-origin",headers:{"X-CSRF-Token":h.default.get("current_session.csrf_token")}}).then(function(t){if(!t.ok)throw new Error}).catch(function(){e.toggleState()}),this.control.blur()}},{key:"toggleState",value:function(){this.state.isSubscribed=!this.state.isSubscribed,this.hasCounter&&(this.state.counter+=this.state.isSubscribed?1:-1),this.render()}},{key:"render",value:function(){var t=this.getStateAttributes();this.control.className=t.class,this.control.textContent=t.label,this.control.setAttribute("aria-selected",this.state.isSubscribed),this.hasCounter&&(this.control.dataset.followerCount=this.state.counter)}}]),t}();e.default=f},160:function(t,e,s){t.exports={default:s(301),__esModule:!0}},203:function(t,e,s){var r=s(50),n=s(22),i=s(54);t.exports=function(t,e){var s=(n.Object||{})[t]||Object[t],o={};o[t]=e(s),r(r.S+r.F*i(function(){s(1)}),"Object",o)}},301:function(t,e,s){s(302),t.exports=s(22).Object.keys},302:function(t,e,s){var r=s(72),n=s(64);s(203)("keys",function(){return function(t){return n(r(t))}})}});